<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Kigali Cooker Catering</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/pages.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#FF8F00">
</head>

<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">
                <div class="brand-icon">üç≥</div><span>Kigali Cooker</span>
            </a>
            <div class="nav-links">
                <a href="index.html" data-i18n="nav_home">Home</a>
                <a href="training.html" data-i18n="nav_training">Training</a>
                <a href="workers.html" data-i18n="nav_workers">Workers</a>
                <a href="book-service.html" data-i18n="nav_services">Book Service</a>
            </div>
            <div class="nav-actions">
                <div class="lang-toggle">
                    <button class="lang-btn active" data-lang="en">EN</button>
                    <button class="lang-btn" data-lang="kn">KN</button>
                </div>
                <a href="register.html" class="btn btn-sm btn-primary auth-register"
                    data-i18n="nav_register">Register</a>
            </div>
            <button class="hamburger"><span></span><span></span><span></span></button>
        </div>
    </nav>

    <section class="page-header">
        <div class="container">
            <h1 data-i18n="login_title">Welcome Back</h1>
            <p>Login to access your dashboard and book services.</p>
        </div>
    </section>

    <section class="section">
        <div class="container" style="max-width:480px;">
            <div class="card" style="padding:var(--space-xl);">
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" data-i18n="email">Email Address</label>
                        <input type="email" class="form-input" id="loginEmail" required placeholder="you@example.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label" data-i18n="password">Password</label>
                        <input type="password" class="form-input" id="loginPassword" required
                            placeholder="Enter password">
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg" style="width:100%;"
                        data-i18n="login_btn">Login</button>
                </form>
                <div style="text-align:center;margin-top:var(--space-lg);">
                    <p style="color:var(--text-dark-secondary);margin-bottom:var(--space-sm);">
                        <span data-i18n="no_account">Don't have an account?</span>
                        <a href="register.html" data-i18n="nav_register">Register</a>
                    </p>
                    <p style="color:var(--neutral-500);font-size:0.8rem;">Admin: admin@kigali.com / admin123</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer placeholder (dynamic) -->
    <footer class="footer"></footer>
    <a href="https://wa.me/250789296912" target="_blank" class="whatsapp-fab">üí¨</a>

    <script src="js/data.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/app.js"></script>
    <script>
        document.getElementById('loginForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            // Check admin
            if (email === SEED_DATA.admin.email && password === SEED_DATA.admin.password) {
                loginUser({ id: 'admin', name: 'Admin', email, isAdmin: true, role: 'admin' });
                showToast('Welcome, Admin!', 'success');
                setTimeout(() => window.location.href = 'admin.html', 1000);
                return;
            }

            // Check users
            const users = getUsers();
            const user = users.find(u => u.email === email && u.password === password);
            if (user) {
                loginUser({ ...user, isAdmin: false, role: 'client' });
                showToast('Welcome back, ' + user.name + '!', 'success');
                setTimeout(() => window.location.href = 'dashboard.html', 1000);
                return;
            }

            // Check workers
            const workers = getWorkers();
            const worker = workers.find(w => w.email === email && w.password === password);
            if (worker) {
                loginUser({ ...worker, isAdmin: false, role: 'worker' });
                showToast('Welcome back, ' + worker.name + '!', 'success');
                localStorage.setItem('kc_showDownloadPrompt', 'true');
                setTimeout(() => window.location.href = 'dashboard.html', 1000);
                return;
            }

            showToast('Invalid email or password!', 'error');
        });
    </script>
</body>

</html>